{% extends 'base.html' %}
    {% load static %}
    {% block title %} Product Registration {% endblock %}
    {% block content %}
    <!-- Title Banner -->
    <section class="bg-title-page p-t-40 p-b-50 flex-col-c-m" style="background-image: url({% static 'images/heading-pages-06.jpg' %});">
		<h2 class="l-text2 t-center">
			Product Registration
		</h2>
	</section>
    <!-- --- -->
    <section class="bgwhite p-t-66 p-b-60">
    <div class="container">
    <div class="row">
    <div class="col-md-6 p-b-30">
        <form class ="leave-comment" method="POST" >
            {% csrf_token %}
            <div class="bo4 of-hidden size15 m-b-20">
                <input class="sizefull s-text7 p-l-22 p-r-22" type="text" id="user" name="username" placeholder="Username">
            </div>
            <div class="bo4 of-hidden size15 m-b-20">
                <input class="sizefull s-text7 p-l-22 p-r-22" type="password" id="pass" name="password" placeholder="Password">
            </div>
            <button class="flex-c-m size2 bg1 bo-rad-23 hov1 m-text3 trans-0-4" id="submit-button" type="submit">
                LOGIN
            </button>
            <!-- <input type="text" id="user" name="username">
            <input type="password" id="pass" name="password">
            <button id="submit-button" type="submit">Login</button> -->
        </form>
    </div>
        <!-- <div id="response-data">Still haven't logged in</div> -->
        <div id="disp-button" style= "visibility: hidden">
            <!-- <button id="view-button" type="submit">Click to View data</button>
            <div id="sample-data">No data</div> -->
            <button class="flex-c-m size2 bg1 bo-rad-23 hov1 m-text3 trans-0-4" id="logout-button" type="submit">
                LOGOUT
            </button>
        </div>
        <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
	    <script type="text/javascript">
            //---------------------Login function
    	    $(document).ready(function(){
                $("#submit-button").on("click", function(e){
                    e.preventDefault();
                    userName = $("#user").val();  //Get value using ID for username and password
                    passWord = $("#pass").val();
                    $.ajax({
                        type: "POST",
                        url: "{% url 'auth-login' %}", //"name" in urls.py file
                        data: {                        // Json object
                            "username": userName,
                            "password": passWord
                        },
                        dataType: "JSON",
                        success: function(data){
                        // console.log(data);  To check if token is being returned
                            localStorage.setItem('token', data.token)
                            document.getElementById('disp-button').style.visibility = 'visible'
                    // start-------
                        $.ajax({
                            type: "GET",
                            url: "{% url 'api-view-data' %}", //"name" in urls.py file
                            headers: {
                                "Authorization": "Token "+localStorage.getItem('token')
                            },
                            success: function(data){
                            var json = JSON.parse(data); //Parse Json data to access
                            // console.log(json[0].fields);
                            $("#email-disp").text("Hello " + json[0].fields.username)
                            $("#sign-up-icon").attr("href", "#");
                            },
                        }) 
                        // End-----------------------
                    },
                    error: function(data, status) {
                        console.log(data.responseJSON); //Return error data
                        alert("Invalid Credentials!")
                    }, 
                    complete: function(){
                        $("#user").val('');
                        $("#pass").val('');
                    }
                })
            })
 
            $("#logout-button").on("click", function(e){
                e.preventDefault();
                $.ajax({
                    success: function(){
                        localStorage.clear();
                        document.getElementById('disp-button').style.visibility = 'hidden'
                    },
                    complete: function() {
                        $("#sample-data").text('No data')
                        window.location.reload("http://127.0.0.1:8000/login")
                    }
                })
                })
            })
        </script> -->
        
        </div>
    </div>
    </section>
    {% endblock %}